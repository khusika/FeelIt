{{- $pwa := .Scratch.Get "pwa" -}}
{{- if $pwa -}}
{{- $version := printf "%s-%d" (.Scratch.Get "version") now.Unix -}}
<script>
if ('serviceWorker' in navigator) {
    navigator.serviceWorker
        .register('/sw.min.js?version={{ $version }}', { scope: '/' })
        .then(() => {
            console.info('{{- .Site.Title -}}\u00A0Service Worker Registered');
        }, err => console.error('{{- .Site.Title -}}\u00A0Service Worker registration failed: ', err));

    navigator.serviceWorker
        .ready
        .then(() => {
            console.info('{{- .Site.Title -}}\u00A0Service Worker Ready');
        });
}
</script>
{{- end -}}
